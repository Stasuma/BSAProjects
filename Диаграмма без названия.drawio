<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36" version="29.1.1">
  <diagram name="Страница-1" id="qmFqLQApSP7rH4EX1XXV">
    <mxGraphModel dx="2562" dy="1244" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="XvimeytkLVg6_shggVR7-69" edge="1" parent="1" source="XvimeytkLVg6_shggVR7-62" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;startSize=8;endSize=8;labelBackgroundColor=none;strokeColor=#A8201A;fontColor=default;" target="XvimeytkLVg6_shggVR7-68">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-62" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fontSize=15;labelBackgroundColor=none;fillColor=#FAE5C7;strokeColor=#0F8B8D;fontColor=#143642;" value="&lt;font&gt;FRONT&lt;/font&gt;" vertex="1">
          <mxGeometry height="62.75" width="100" x="190" y="418.51" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-65" edge="1" parent="1" source="XvimeytkLVg6_shggVR7-63" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;startSize=8;endSize=8;labelBackgroundColor=none;strokeColor=#A8201A;fontColor=default;" target="XvimeytkLVg6_shggVR7-62">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-63" parent="1" style="shape=umlActor;verticalLabelPosition=bottom;verticalAlign=top;html=1;outlineConnect=0;labelBackgroundColor=none;fillColor=#FAE5C7;strokeColor=#0F8B8D;fontColor=#143642;" value="Actor" vertex="1">
          <mxGeometry height="80" width="50" x="40" y="409.5" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-64" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=24;fontColor=#143642;labelBackgroundColor=#E6FFCC;fontStyle=1" value="Сохранение введённых банковских данных&amp;nbsp;" vertex="1">
          <mxGeometry height="30" width="660" x="581" y="70" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-67" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=15;labelBackgroundColor=none;fontColor=#143642;" value="Вводит данные" vertex="1">
          <mxGeometry height="30" width="60" x="110" y="409.5" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-71" edge="1" parent="1" source="XvimeytkLVg6_shggVR7-68" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;startSize=8;endSize=8;labelBackgroundColor=none;strokeColor=#A8201A;fontColor=default;" target="XvimeytkLVg6_shggVR7-70">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-79" edge="1" parent="1" source="XvimeytkLVg6_shggVR7-68" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontSize=12;startSize=8;endSize=8;exitX=0.5;exitY=0;exitDx=0;exitDy=0;labelBackgroundColor=none;strokeColor=#A8201A;fontColor=default;" target="XvimeytkLVg6_shggVR7-77">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-80" connectable="0" parent="XvimeytkLVg6_shggVR7-79" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=15;labelBackgroundColor=none;fontColor=#143642;" value="токена нет&amp;nbsp;&lt;div&gt;такого&lt;/div&gt;" vertex="1">
          <mxGeometry relative="1" x="0.4061" y="-2" as="geometry">
            <mxPoint x="-47" y="-5" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-81" edge="1" parent="1" source="XvimeytkLVg6_shggVR7-68" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;fontSize=12;startSize=8;endSize=8;labelBackgroundColor=none;strokeColor=#A8201A;fontColor=default;" target="XvimeytkLVg6_shggVR7-78">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-82" connectable="0" parent="XvimeytkLVg6_shggVR7-81" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=15;labelBackgroundColor=none;fontColor=#143642;" value="уточнения прав и получения&amp;nbsp;&lt;div&gt;доп. атрибутов&amp;nbsp;&lt;span style=&quot;background-color: light-dark(#ffffff, var(--ge-dark-color, #121212)); color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;пользователя.&lt;/span&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry relative="1" x="0.0689" y="-1" as="geometry">
            <mxPoint x="116" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-68" parent="1" style="rhombus;whiteSpace=wrap;html=1;fontSize=13;labelBackgroundColor=none;fillColor=#FAE5C7;strokeColor=#0F8B8D;fontColor=#143642;" value="&amp;nbsp;API&amp;nbsp;&lt;div&gt;Gateway&lt;/div&gt;" vertex="1">
          <mxGeometry height="115" width="120" x="442.5" y="392" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-83" edge="1" parent="1" source="XvimeytkLVg6_shggVR7-70" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;fontSize=12;startSize=8;endSize=8;entryX=0.25;entryY=1;entryDx=0;entryDy=0;exitX=0.25;exitY=0;exitDx=0;exitDy=0;labelBackgroundColor=none;strokeColor=#A8201A;fontColor=default;" target="XvimeytkLVg6_shggVR7-84">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="960" y="290" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-88" edge="1" parent="1" source="XvimeytkLVg6_shggVR7-70" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;startSize=8;endSize=8;labelBackgroundColor=none;strokeColor=#A8201A;fontColor=default;" target="XvimeytkLVg6_shggVR7-87">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-70" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fontSize=15;labelBackgroundColor=none;fillColor=#FAE5C7;strokeColor=#0F8B8D;fontColor=#143642;" value="&lt;font&gt;middle сервис шифрования&lt;/font&gt;" vertex="1">
          <mxGeometry height="88" width="120" x="900" y="405.88" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-72" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=15;labelBackgroundColor=none;fontColor=#143642;" value="Маршрутизирует в нужный&amp;nbsp;middle сервис&amp;nbsp;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(20, 54, 66), rgb(173, 202, 213));&quot;&gt;и сохраняет данные о пользователе&amp;nbsp;&lt;/span&gt;" vertex="1">
          <mxGeometry height="30" width="270" x="590" y="410" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-73" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;labelBackgroundColor=none;fontColor=#143642;fontSize=15;" value="&lt;font&gt;Отправляет запрос +&amp;nbsp;JWT&amp;nbsp;по защищённому каналу (HTTPS/TLS&lt;/font&gt;&lt;font&gt;)&lt;/font&gt;" vertex="1">
          <mxGeometry height="30" width="147.5" x="300" y="392" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-74" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;labelBackgroundColor=none;fontColor=#143642;fontSize=15;" value="выполняет проверку корректности номера карты (например, проверка по алгоритму Луна)&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;div&gt;номер карты сразу шифруется алгоритмом AES-256 с использованием полученного секретного ключа.&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;Ключ хранится отдельно в системе управления ключами (KMS), не доступен напрямую приложению или базе.​&lt;/div&gt;&lt;/div&gt;" vertex="1">
          <mxGeometry height="190" width="240" x="850" y="530" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-76" parent="1" style="text;whiteSpace=wrap;labelBackgroundColor=none;fontColor=#143642;fontSize=15;" value="Принимает входящий запрос.&#xa;&#xa;Проверяет аутентификацию, то есть валидирует токены доступа (например, JWT): цифровая подпись токена + срок действия&#xa;&#xa;Выполняет базовую авторизацию, проверяя, есть ли у пользователя права на доступ к определённому API или маршруту (например, по ролям в токене).&#xa;&#xa;Отсеивает неавторизованные или неподходящие запросы." vertex="1">
          <mxGeometry height="170" width="299" x="411" y="500" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-77" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fontSize=15;labelBackgroundColor=none;fillColor=#FAE5C7;strokeColor=#0F8B8D;fontColor=#143642;" value="&lt;font&gt;middle сервис аутентификации&lt;/font&gt;" vertex="1">
          <mxGeometry height="74.5" width="135" x="435" y="180" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-78" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fontSize=15;labelBackgroundColor=none;fillColor=#FAE5C7;strokeColor=#0F8B8D;fontColor=#143642;" value="&lt;font&gt;middle сервис авторизации&lt;/font&gt;" vertex="1">
          <mxGeometry height="75.5" width="123" x="630" y="180" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-86" edge="1" parent="1" source="XvimeytkLVg6_shggVR7-84" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.75;entryY=0;entryDx=0;entryDy=0;fontSize=12;startSize=8;endSize=8;labelBackgroundColor=none;strokeColor=#A8201A;fontColor=default;" target="XvimeytkLVg6_shggVR7-70">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-84" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fontSize=15;labelBackgroundColor=none;fillColor=#FAE5C7;strokeColor=#0F8B8D;fontColor=#143642;" value="&lt;font&gt;сервис AWS KMS&lt;/font&gt;" vertex="1">
          <mxGeometry height="75.5" width="123" x="898" y="210" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-85" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=15;labelBackgroundColor=none;fontColor=#143642;" value="&lt;font&gt;генерацию временного ключа данных (Data Encryption Key, DEK).&lt;/font&gt;" vertex="1">
          <mxGeometry height="30" width="160" x="1040" y="220" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-87" parent="1" style="rounded=1;whiteSpace=wrap;html=1;fontSize=15;labelBackgroundColor=none;fillColor=#FAE5C7;strokeColor=#0F8B8D;fontColor=#143642;" value="&lt;font&gt;back сервис&lt;/font&gt;" vertex="1">
          <mxGeometry height="88" width="120" x="1200" y="405.5" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-96" edge="1" parent="1" source="XvimeytkLVg6_shggVR7-89" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;strokeColor=#A8201A;fontSize=12;fontColor=#143642;startSize=8;endSize=8;fillColor=#FAE5C7;">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1650" y="450" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-89" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;labelBackgroundColor=none;fillColor=#FAE5C7;strokeColor=#0F8B8D;fontColor=#143642;" value="НРБД" vertex="1">
          <mxGeometry height="100" width="100" x="1490" y="320" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-90" edge="1" parent="1" source="XvimeytkLVg6_shggVR7-87" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=12;startSize=8;endSize=8;labelBackgroundColor=none;strokeColor=#A8201A;fontColor=default;" target="XvimeytkLVg6_shggVR7-89">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-91" connectable="0" parent="XvimeytkLVg6_shggVR7-90" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=15;labelBackgroundColor=none;fontColor=#143642;" value="Сохраение данных" vertex="1">
          <mxGeometry relative="1" x="-0.262" as="geometry">
            <mxPoint x="17" y="-16" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-97" edge="1" parent="1" source="XvimeytkLVg6_shggVR7-92" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;exitPerimeter=0;strokeColor=#A8201A;fontSize=12;fontColor=#143642;startSize=8;endSize=8;fillColor=#FAE5C7;">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="1650" y="470" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-92" parent="1" style="shape=cylinder3;whiteSpace=wrap;html=1;boundedLbl=1;backgroundOutline=1;size=15;labelBackgroundColor=none;fillColor=#FAE5C7;strokeColor=#0F8B8D;fontColor=#143642;" value="РБД" vertex="1">
          <mxGeometry height="100" width="100" x="1490" y="500" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-93" edge="1" parent="1" source="XvimeytkLVg6_shggVR7-87" style="edgeStyle=none;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.75;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;entryPerimeter=0;fontSize=12;startSize=8;endSize=8;labelBackgroundColor=none;strokeColor=#A8201A;fontColor=default;" target="XvimeytkLVg6_shggVR7-92">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-94" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=16;labelBackgroundColor=none;fontColor=#143642;" value="В РБД хранятся основные данные пользователя (имя, email, роли, заказы и т.д.) + зашифрованный номер карты с уникальным идентификатором пользователя (UserID)." vertex="1">
          <mxGeometry height="30" width="280" x="1430" y="653.88" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-95" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=16;fontColor=#143642;" value="В НРБД хранятся хеши паролей и, возможно, история смены паролей, связанные с тем же UserID." vertex="1">
          <mxGeometry height="92.75" width="180" x="1450" y="210" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-98" parent="1" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;fontSize=16;fontColor=#143642;" value="UserID" vertex="1">
          <mxGeometry height="30" width="60" x="1650" y="440" as="geometry" />
        </mxCell>
        <mxCell id="XvimeytkLVg6_shggVR7-99" connectable="0" parent="1" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=15;labelBackgroundColor=none;fontColor=#143642;" value="Сохраение данных" vertex="1">
          <mxGeometry x="1400" y="507" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
